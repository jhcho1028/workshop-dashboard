<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>ì›Œí¬ìƒµ ì§„í–‰ í˜„í™©íŒ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            color: white;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        /* íƒ­ ë„¤ë¹„ê²Œì´ì…˜ */
        .tab-navigation {
            display: flex;
            justify-content: center;
            margin-bottom: 10px;
            margin-top: 10px;
        }

        .tab-button {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: none;
            padding: 6px 12px;
            margin: 0 2px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 500;
            transition: all 0.2s ease;
        }

        .tab-button.active {
            background: rgba(255, 255, 255, 0.3);
            color: white;
            transform: none;
        }

        .tab-button:hover:not(.active) {
            background: rgba(255, 255, 255, 0.2);
        }


        /* íƒ­ ì»¨í…ì¸  */
        .tab-content {
            display: none;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            min-height: 600px;
        }

        .tab-content.active {
            display: block;
        }

        /* ëŒ€ì‹œë³´ë“œ ë ˆì´ì•„ì›ƒ */
        .dashboard-layout {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 30px;
            height: 100%;
        }

        .groups-section {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
        }

        .scoreboard-section {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
        }

        /* ëª¨ë“œ ì „í™˜ ë²„íŠ¼ */
        .mode-controls {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 20px;
            gap: 20px;
        }

        .mode-toggle {
            display: flex;
            background: #e2e8f0;
            border-radius: 8px;
            padding: 4px;
        }

        .mode-button {
            background: transparent;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .mode-button.active {
            background: white;
            color: #667eea;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        /* ì¡° ê·¸ë¦¬ë“œ */
        .groups-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        .group-card {
            background: white;
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            border: 2px solid transparent;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
        }

        .group-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.15);
        }

        .group-card.editing {
            border-color: #667eea;
        }

        .group-card.clickable {
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .group-card.clickable:hover {
            border-color: #667eea;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }


        .group-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .group-title {
            font-size: 20px;
            font-weight: bold;
            color: #4a5568;
            position: relative;
        }

        .group-number {
            position: absolute;
            top: -5px;
            left: -5px;
            font-size: 10px;
            color: #a0aec0;
            font-weight: normal;
        }

        .group-custom-name {
            font-size: 20px;
            font-weight: bold;
            color: #4a5568;
            margin-top: 8px;
            min-height: 24px;
            display: flex;
            align-items: center;
        }

        .group-leader {
            background: #ffd700;
            color: #333;
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 14px;
            font-weight: bold;
            margin-bottom: 8px;
            display: inline-block;
        }

        .group-members {
            display: flex;
            flex-wrap: wrap;
            gap: 4px;
        }

        .member-tag {
            background: #667eea;
            color: white;
            padding: 4px 8px;
            border-radius: 3px;
            font-size: 13px;
        }

        .member-tag.leader {
            background: #ffd700;
            color: #333;
            font-weight: bold;
        }

        /* ì ìˆ˜íŒ */
        .scoreboard-title {
            font-size: 24px;
            font-weight: bold;
            color: #4a5568;
            margin-bottom: 20px;
            text-align: center;
        }

        .score-table {
            width: 100%;
            border-collapse: collapse;
        }

        .score-table th,
        .score-table td {
            padding: 16px 12px;
            text-align: center;
            border: 1px solid #e2e8f0;
        }

        .score-table th {
            background: #4a5568;
            color: white;
            font-weight: 600;
            font-size: 16px;
        }

        .score-table td {
            font-size: 16px;
        }

        .score-table tr:nth-child(even) {
            background: #f7fafc;
        }

        .score-table tr:hover {
            background: #edf2f7;
        }

        .rank-1 { background: #ffd700 !important; color: #333; font-weight: bold; }
        .rank-2 { background: #c0c0c0 !important; color: #333; font-weight: bold; }
        .rank-3 { background: #cd7f32 !important; color: white; font-weight: bold; }

        .score-input {
            width: 80px;
            padding: 8px;
            border: 1px solid #e2e8f0;
            border-radius: 4px;
            text-align: center;
            font-size: 16px;
        }

        .score-buttons {
            display: flex;
            gap: 4px;
            width: 100%;
            margin: 6px 0;
            justify-content: center;
        }

        .score-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 6px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s ease;
            min-height: 28px;
            min-width: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex: 1;
        }

        .score-btn:hover {
            background: #5a67d8;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .score-btn.minus {
            background: #e53e3e;
        }

        .score-btn.minus:hover {
            background: #c53030;
        }

        /* ì „ì—­ ì ìˆ˜ ì¡°ì • íŒ¨ë„ */
        .score-adjust-panel {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            padding: 8px 15px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
            min-width: 500px;
            max-width: 600px;
        }

        .panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 6px;
        }

        .group-name {
            color: #2d3748;
            font-size: 13px;
            font-weight: 600;
            text-align: left;
        }

        .current-score-display {
            font-size: 11px;
            color: #4a5568;
            text-align: right;
        }

        .current-score-display span {
            font-weight: bold;
            color: #667eea;
            font-size: 13px;
        }


        /* ì„¤ì • í™”ë©´ */
        .settings-content {
            max-width: 800px;
            margin: 0 auto;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #4a5568;
            font-size: 14px;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: #667eea;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
            margin-right: 10px;
            margin-bottom: 10px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .btn-secondary {
            background: #718096;
        }

        .btn-danger {
            background: #e53e3e;
        }

        .btn-success {
            background: #38a169;
        }

        /* ì°¸ê°€ì ëª©ë¡ - ì—‘ì…€ ìŠ¤íƒ€ì¼ */
        .participant-list {
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            background: white;
        }

        .participant-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 1px;
            background: #e2e8f0;
        }

        .participant-item {
            background: white;
            padding: 6px 8px;
            font-size: 12px;
            border-radius: 2px;
            transition: all 0.2s ease;
            cursor: pointer;
            position: relative;
        }

        .participant-item:hover {
            background: #f0f4f8;
        }

        .participant-item.assigned {
            background: #e6fffa;
            color: #234e52;
            font-weight: 600;
        }

        .participant-item.leader {
            background: #fef5e7;
            color: #744210;
            font-weight: bold;
        }

        .participant-item.assigned.leader {
            background: #fef3c7;
            color: #92400e;
        }

        .participant-item .group-badge {
            position: absolute;
            top: 2px;
            right: 2px;
            background: #667eea;
            color: white;
            font-size: 10px;
            padding: 2px 4px;
            border-radius: 3px;
            font-weight: bold;
        }

        .participant-item.leader .group-badge {
            background: #f59e0b;
        }

        /* ë“œë¡­ë‹¤ìš´ ìŠ¤íƒ€ì¼ */
        .dropdown {
            position: relative;
            display: inline-block;
        }

        .dropdown-content {
            display: none;
            position: absolute;
            background-color: white;
            min-width: 120px;
            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
            z-index: 1;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
        }

        .dropdown-content a {
            color: #333;
            padding: 12px 16px;
            text-decoration: none;
            display: block;
            cursor: pointer;
        }

        .dropdown-content a:hover {
            background-color: #f1f1f1;
        }

        .dropdown:hover .dropdown-content {
            display: block;
        }

        @media (max-width: 1200px) {
            .groups-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        @media (max-width: 768px) {
            .dashboard-layout {
                grid-template-columns: 1fr;
            }
            
            .groups-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .header h1 {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 style="display: inline;">ì†Œ</h1><h4 style="display: inline;">í”„íŠ¸ì›¨ì–´</h4><h1 style="display: inline;">ë‹¤</h1><h4 style="display: inline;">í•¨ê»˜</h4><h4 style="display: inline;"> ì›Œí¬</h4><h1 style="display: inline;">ìƒµ</h1>
        </div>
        
        <!-- ë°ì´í„° ìƒíƒœ í‘œì‹œ (ìš°ìƒë‹¨) -->
        <div id="dataStatus" style="position: fixed; top: 20px; right: 20px; font-size: 12px; padding: 8px 12px; background: rgba(255,255,255,0.9); border-radius: 6px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); z-index: 1000; color: #333;">
            <!-- ë°ì´í„° ìƒíƒœê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
        </div>

        <!-- íƒ­ ë„¤ë¹„ê²Œì´ì…˜ -->
        <div class="tab-navigation">
            <button class="tab-button active" onclick="switchTab('dashboard')">ëŒ€ì‹œë³´ë“œ</button>
            <button class="tab-button" onclick="switchTab('settings')">ì„¤ì •</button>
            <button class="tab-button" onclick="switchTab('etc')">ê¸°íƒ€</button>
        </div>

        <!-- ëŒ€ì‹œë³´ë“œ íƒ­ -->
        <div id="dashboard-tab" class="tab-content active">
            <div class="mode-controls">
                <div>
                    <!-- ì „ì—­ ì ìˆ˜ ì¡°ì • íŒ¨ë„ -->
                    <div id="scoreAdjustPanel" class="score-adjust-panel">
                        <div class="panel-header">
                            <div class="group-name" id="selectedGroupName">ì¡°ë¥¼ ì„ íƒí•˜ì„¸ìš”</div>
                            <div class="current-score-display">
                                í˜„ì¬ ì ìˆ˜: <span id="currentScoreValue">0</span>ì 
                            </div>
                        </div>
                        <div class="score-buttons">
                            <button class="score-btn minus" onclick="adjustScore(-30)">-30</button>
                            <button class="score-btn minus" onclick="adjustScore(-20)">-20</button>
                            <button class="score-btn minus" onclick="adjustScore(-15)">-15</button>
                            <button class="score-btn minus" onclick="adjustScore(-10)">-10</button>
                            <button class="score-btn minus" onclick="adjustScore(-5)">-5</button>
                            <button class="score-btn" onclick="adjustScore(5)">+5</button>
                            <button class="score-btn" onclick="adjustScore(10)">+10</button>
                            <button class="score-btn" onclick="adjustScore(15)">+15</button>
                            <button class="score-btn" onclick="adjustScore(20)">+20</button>
                            <button class="score-btn" onclick="adjustScore(30)">+30</button>
                        </div>
                    </div>
                </div>
                <div>
                    <button class="btn btn-secondary" onclick="resetScores()">ì ìˆ˜ ì´ˆê¸°í™”</button>
                </div>
            </div>

            <div class="dashboard-layout">

                <!-- ì¡° í˜„í™© ì„¹ì…˜ -->
                <div class="groups-section">
                    <h2 style="margin-bottom: 20px; color: #4a5568;">ì¡° í˜„í™©</h2>
                    <div class="groups-grid" id="groupsGrid">
                        <!-- 8ì¡°ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                    </div>
                </div>

                <!-- ì ìˆ˜íŒ ì„¹ì…˜ -->
                <div class="scoreboard-section">
                    <div class="scoreboard-title">ì ìˆ˜íŒ</div>
                    <table class="score-table" id="scoreTable">
                        <thead>
                            <tr>
                                <th>ìˆœìœ„</th>
                                <th>ì¡°ëª…</th>
                                <th>ì ìˆ˜</th>
                            </tr>
                        </thead>
                        <tbody id="scoreTableBody">
                            <!-- ì ìˆ˜ ë°ì´í„°ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- ì„¤ì • íƒ­ -->
        <div id="settings-tab" class="tab-content">
            <div class="settings-content">
                <!-- ì°¸ê°€ì ê´€ë¦¬ -->
                <div class="form-group">
                    <label for="excelInput">ì°¸ê°€ì ë“±ë¡ (ì—‘ì…€ ë³µì‚¬/ë¶™ì—¬ë„£ê¸°):</label>
                    <textarea id="excelInput" rows="6" placeholder="ì—‘ì…€ì—ì„œ ë³µì‚¬í•œ ì°¸ê°€ì ì´ë¦„ë“¤ì„ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”. ê° ì¤„ì— í•œ ëª…ì”© ì…ë ¥í•˜ê±°ë‚˜ íƒ­ìœ¼ë¡œ êµ¬ë¶„í•˜ì—¬ ì…ë ¥í•˜ì„¸ìš”."></textarea>
                </div>
                <button class="btn" onclick="importParticipants()">ì°¸ê°€ì ë“±ë¡</button>
                <button class="btn btn-danger" onclick="clearAllData()">ì „ì²´ ë°ì´í„° ì‚­ì œ</button>
                
                <!-- Electron íŒŒì¼ ê´€ë¦¬ -->
                <div style="margin-top: 20px; padding: 15px; background: #f0f4f8; border-radius: 8px;">
                    <h4 style="margin-bottom: 10px; color: #4a5568;">íŒŒì¼ ê´€ë¦¬</h4>
                    <p style="font-size: 12px; color: #718096; margin-bottom: 10px;">
                        ë°ì´í„°ëŠ” ìë™ìœ¼ë¡œ workshop-data.json íŒŒì¼ì— ì €ì¥ë©ë‹ˆë‹¤. ì™¸ë¶€ íŒŒì¼ì„ ê°€ì ¸ì˜¤ê±°ë‚˜ ë°±ì—…ì„ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                    </p>
                    <button class="btn btn-secondary" onclick="loadFromExternalFile()">ì™¸ë¶€ íŒŒì¼ ê°€ì ¸ì˜¤ê¸°</button>
                    <button class="btn btn-secondary" onclick="downloadData()">ë°±ì—… íŒŒì¼ ì €ì¥</button>
                </div>
                

                <!-- ì°¸ê°€ì ëª©ë¡ -->
                <div class="form-group">
                    <label>ë“±ë¡ëœ ì°¸ê°€ì ëª©ë¡:</label>
                    <div class="participant-list" id="participantList">
                        <!-- ì°¸ê°€ì ëª©ë¡ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                    </div>
                </div>

                <!-- ì¡° í¸ì„± -->
                <div class="form-group">
                    <h3 style="margin-bottom: 15px; color: #4a5568;">ì¡° í¸ì„±</h3>
                    
                    <!-- ì¡° ìˆ˜ ì„¤ì • -->
                    <div style="margin-bottom: 20px; padding: 15px; background: #f8f9fa; border-radius: 8px;">
                        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                            <h4 style="margin: 0; color: #4a5568;">í˜„ì¬ ${groups.length}ê°œ ì¡°ê°€ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤.</h4>
                        </div>
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <label style="font-size: 14px; color: #718096;">ì´ ì¡° ìˆ˜:</label>
                            <input type="number" id="totalGroups" min="1" max="20" value="8" 
                                   onchange="updateGroupCount(this.value)"
                                   style="width: 80px; padding: 6px; border: 1px solid #e2e8f0; border-radius: 4px;">
                            <button class="btn btn-secondary" onclick="applyGroupCount()" style="padding: 6px 12px; font-size: 12px;">ì ìš©</button>
                        </div>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;" id="groupAssignment">
                        <!-- ì¡°ë³„ í¸ì„± ì¸í„°í˜ì´ìŠ¤ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                    </div>
                </div>
            </div>
        </div>

        <!-- ê¸°íƒ€ íƒ­ -->
        <div id="etc-tab" class="tab-content">
            <div class="settings-content">
                <!-- ì›Œí¬ìƒµ ì°¸ê³  ì‚¬ì´íŠ¸ -->
                <div class="form-group">
                    <h3 style="margin-bottom: 20px; color: #4a5568;">ìœ ìš©í•œ ì°¸ê³  ì‚¬ì´íŠ¸</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                        <div style="background: #f8f9fa; border-radius: 10px; padding: 20px; border: 1px solid #e2e8f0;">
                            <h4 style="margin-bottom: 15px; color: #4a5568;">ì›Œí¬ìƒµ ë„êµ¬</h4>
                            <div style="display: flex; flex-direction: column; gap: 10px;">
                                <a href="https://lazygyu.github.io/roulette/" target="_blank" style="color: #667eea; text-decoration: none; padding: 8px; background: white; border-radius: 6px; border: 1px solid #e2e8f0; transition: all 0.2s ease;">
                                    ğŸ¯ ë§ˆë¸” ë£°ë › - ë‹¹ì²¨ì ë½‘ê¸°
                                </a>
                            </div>
                        </div>
                        
                        <div style="background: #f8f9fa; border-radius: 10px; padding: 20px; border: 1px solid #e2e8f0;">
                            <h4 style="margin-bottom: 15px; color: #4a5568;">ì‹œê°„ ê´€ë¦¬</h4>
                            
                            <!-- íƒ€ì´ë¨¸ -->
                            <div style="margin-bottom: 20px;">
                                <h5 style="margin-bottom: 10px; color: #4a5568;">â° íƒ€ì´ë¨¸</h5>
                                <div style="text-align: center;">
                                    <div id="timerDisplay" style="font-size: 36px; font-weight: bold; color: #4a5568; margin-bottom: 10px; font-family: 'Courier New', monospace;">
                                        00:00:00
                                    </div>
                                    <div style="display: flex; gap: 8px; justify-content: center; margin-bottom: 10px;">
                                        <input type="number" id="timerMinutes" placeholder="ë¶„" min="0" max="59" 
                                               style="width: 60px; padding: 6px; border: 1px solid #e2e8f0; border-radius: 4px; text-align: center; font-size: 14px;">
                                        <span style="font-size: 16px; color: #718096;">:</span>
                                        <input type="number" id="timerSeconds" placeholder="ì´ˆ" min="0" max="59" 
                                               style="width: 60px; padding: 6px; border: 1px solid #e2e8f0; border-radius: 4px; text-align: center; font-size: 14px;">
                                    </div>
                                    <div style="display: flex; gap: 8px; justify-content: center;">
                                        <button class="btn" onclick="startTimer()" id="timerStartBtn" style="padding: 6px 12px; font-size: 12px;">ì‹œì‘</button>
                                        <button class="btn btn-secondary" onclick="pauseTimer()" id="timerPauseBtn" disabled style="padding: 6px 12px; font-size: 12px;">ì •ì§€</button>
                                        <button class="btn btn-secondary" onclick="resetTimer()" style="padding: 6px 12px; font-size: 12px;">ì´ˆê¸°í™”</button>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- ìŠ¤í†±ì›Œì¹˜ -->
                            <div>
                                <h5 style="margin-bottom: 10px; color: #4a5568;">â±ï¸ ìŠ¤í†±ì›Œì¹˜</h5>
                                <div style="text-align: center;">
                                    <div id="stopwatchDisplay" style="font-size: 36px; font-weight: bold; color: #4a5568; margin-bottom: 10px; font-family: 'Courier New', monospace;">
                                        00:00:00
                                    </div>
                                    <div style="display: flex; gap: 8px; justify-content: center;">
                                        <button class="btn" onclick="startStopwatch()" id="stopwatchStartBtn" style="padding: 6px 12px; font-size: 12px;">ì‹œì‘</button>
                                        <button class="btn btn-secondary" onclick="pauseStopwatch()" id="stopwatchPauseBtn" disabled style="padding: 6px 12px; font-size: 12px;">ì •ì§€</button>
                                        <button class="btn btn-secondary" onclick="resetStopwatch()" style="padding: 6px 12px; font-size: 12px;">ì´ˆê¸°í™”</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ì¹´ì¹´ì˜¤í†¡ ì˜¤í”ˆì±„íŒ…ë°© -->
                <div class="form-group">
                    <h3 style="margin-bottom: 20px; color: #4a5568;">ì¹´ì¹´ì˜¤í†¡ ì˜¤í”ˆì±„íŒ…ë°©</h3>
                    <div style="background: #f8f9fa; border-radius: 10px; padding: 20px; border: 1px solid #e2e8f0;">
                        <div style="margin-bottom: 15px;">
                            <label style="font-size: 14px; color: #4a5568; font-weight: 600; display: block; margin-bottom: 8px;">ì˜¤í”ˆì±„íŒ…ë°© ì£¼ì†Œ:</label>
                            <div style="display: flex; gap: 10px; margin-bottom: 10px;">
                                <input type="text" id="kakaoChatUrl" placeholder="https://open.kakao.com/o/..." 
                                       style="flex: 1; padding: 10px; border: 1px solid #e2e8f0; border-radius: 6px; font-size: 14px;">
                            </div>
                            <div style="display: flex; gap: 10px;">
                                <button class="btn" onclick="copyChatUrl()" style="flex: 1; padding: 10px; font-size: 14px;">ì£¼ì†Œ ë³µì‚¬</button>
                                <button class="btn btn-secondary" onclick="openChatRoom()" style="flex: 1; padding: 10px; font-size: 14px;">ì±„íŒ…ë°© ì—´ê¸°</button>
                            </div>
                        </div>
                        
                        <!-- ì±„íŒ…ë°© ì •ë³´ í‘œì‹œ -->
                        <div id="chatRoomInfo" style="background: white; padding: 15px; border-radius: 8px; border: 1px solid #e2e8f0; margin-top: 15px; display: none;">
                            <div style="font-size: 16px; font-weight: bold; color: #4a5568; margin-bottom: 10px;">
                                ğŸ“± ì±„íŒ…ë°© ì •ë³´
                            </div>
                            <div style="font-size: 14px; color: #718096; margin-bottom: 8px;">
                                <strong>ì£¼ì†Œ:</strong> <span id="displayChatUrl">-</span>
                            </div>
                            <div style="font-size: 12px; color: #a0aec0;">
                                ğŸ’¡ ì°¸ê°€ìë“¤ì—ê²Œ QRì½”ë“œë‚˜ ì£¼ì†Œë¥¼ ê³µìœ í•˜ì—¬ ì±„íŒ…ë°©ì— ì°¸ì—¬í•˜ë„ë¡ ì•ˆë‚´í•˜ì„¸ìš”
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ë¬¸ì¥ í¼ì¦ ê²Œì„ -->
                <div class="form-group">
                    <h3 style="margin-bottom: 20px; color: #4a5568;">ë¬¸ì¥ í¼ì¦ ë§ì¶”ê¸°</h3>
                    
                    <!-- ë¬¸ì¥ ì…ë ¥ -->
                    <div style="background: #f8f9fa; border-radius: 10px; padding: 20px; border: 1px solid #e2e8f0; margin-bottom: 20px;">
                        <h4 style="margin-bottom: 15px; color: #4a5568;">ë¬¸ì¥ ì…ë ¥</h4>
                        <div style="margin-bottom: 15px;">
                            <label style="font-size: 14px; color: #4a5568; font-weight: 600; display: block; margin-bottom: 8px;">í¼ì¦ë¡œ ë§Œë“¤ ë¬¸ì¥ì„ ì…ë ¥í•˜ì„¸ìš”:</label>
                            <input type="text" id="puzzleSentence" placeholder="ì˜ˆ: ì˜¤ëŠ˜ì€ ëª¨ë‘ í•¨ê»˜ ì›ƒì–´ë³´ì•„ìš”" 
                                   style="width: 100%; padding: 10px; border: 1px solid #e2e8f0; border-radius: 6px; font-size: 16px;">
                        </div>
                        <div style="display: flex; gap: 10px;">
                            <button class="btn" onclick="createPuzzle()" style="flex: 1;">í¼ì¦ ìƒì„±</button>
                            <button class="btn btn-secondary" onclick="resetPuzzle()" style="flex: 1;">ì´ˆê¸°í™”</button>
                        </div>
                    </div>
                    
                    <!-- í¼ì¦ ê²Œì„ ì˜ì—­ -->
                    <div id="puzzleGameArea" style="background: #f8f9fa; border-radius: 10px; padding: 20px; border: 1px solid #e2e8f0; display: none;">
                        <h4 style="margin-bottom: 15px; color: #4a5568;">ğŸ§© í¼ì¦íŒ</h4>
                        <div style="text-align: center; margin-bottom: 20px;">
                            <div id="puzzleGrid" style="display: inline-grid; gap: 4px; margin-bottom: 15px;">
                                <!-- í¼ì¦ ê·¸ë¦¬ë“œê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                            </div>
                        </div>
                        
                        <div style="text-align: center;">
                            <button class="btn btn-secondary" onclick="shufflePuzzle()">ë‹¤ì‹œ ì„ê¸°</button>
                        </div>
                    </div>
                </div>

                <!-- ë¹™ê³  ê²Œì„ -->
                <div class="form-group">
                    <h3 style="margin-bottom: 20px; color: #4a5568;">ë¹™ê³  ê²Œì„</h3>
                    
                    <!-- ë¹™ê³  í•­ëª© ë“±ë¡ -->
                    <div style="background: #f8f9fa; border-radius: 10px; padding: 20px; border: 1px solid #e2e8f0; margin-bottom: 20px;">
                        <h4 style="margin-bottom: 15px; color: #4a5568;">ë¹™ê³  í•­ëª© ë“±ë¡</h4>
                        <div style="margin-bottom: 15px;">
                            <label style="font-size: 14px; color: #4a5568; font-weight: 600; display: block; margin-bottom: 8px;">ë¹™ê³  í•­ëª© ì…ë ¥ (ê° ì¤„ì— í•˜ë‚˜ì”©):</label>
                            <textarea id="bingoItemsInput" rows="6" placeholder="ì˜ˆ: ì•„ì´ë””ì–´ ë°œìƒ&#10;ë¸Œë ˆì¸ìŠ¤í† ë°&#10;í† ë¡  ì°¸ì—¬&#10;ì§ˆë¬¸í•˜ê¸°&#10;í”¼ë“œë°± ì£¼ê¸°"></textarea>
                        </div>
                        <div style="display: flex; gap: 10px;">
                            <button class="btn" onclick="addBingoItems()" style="flex: 1;">ë¹™ê³  í•­ëª© ë“±ë¡</button>
                            <button class="btn btn-secondary" onclick="clearBingoItems()" style="flex: 1;">ëª©ë¡ ì´ˆê¸°í™”</button>
                        </div>
                    </div>
                    
                    
                    <!-- ë“±ë¡ëœ ë¹™ê³  í•­ëª© ëª©ë¡ -->
                    <div style="background: #f8f9fa; border-radius: 10px; padding: 20px; border: 1px solid #e2e8f0; margin-top: 20px;">
                        <h4 style="margin-bottom: 15px; color: #4a5568;">ë“±ë¡ëœ ë¹™ê³  í•­ëª© ëª©ë¡</h4>
                        <div id="bingoItemsList" style="max-height: 200px; overflow-y: auto; border: 1px solid #e2e8f0; border-radius: 8px; background: white;">
                            <!-- ë¹™ê³  í•­ëª© ëª©ë¡ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <script>
        // ì „ì—­ ì˜¤ë¥˜ í•¸ë“¤ëŸ¬
        window.addEventListener('error', function(e) {
            console.error('JavaScript ì˜¤ë¥˜:', e.error);
            alert('í˜ì´ì§€ì—ì„œ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë¸Œë¼ìš°ì € ì½˜ì†”ì„ í™•ì¸í•˜ê±°ë‚˜ í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•´ì£¼ì„¸ìš”.');
        });

        // ë°ì´í„° ì €ì¥ì†Œ
        let participants = [];
        let groups = [];
        let scores = {};
        let settings = {
            totalGroups: 8,
            maxMembersPerGroup: 6
        };
        let bingoItems = [];
        let checkedItems = new Set(); // ì²´í¬ëœ í•­ëª©ë“¤ì„ ì €ì¥

        // JSON ë°ì´í„°ë² ì´ìŠ¤ íŒŒì¼ëª…
        const DATABASE_FILENAME = 'workshop-data.json';

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', async function() {
            try {
                await loadData();
                initializeGroups();
                updateDisplay();
                updateGroupCountDisplay();
            } catch (error) {
                console.error('í˜ì´ì§€ ì´ˆê¸°í™” ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error);
                alert('í˜ì´ì§€ ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•´ì£¼ì„¸ìš”.');
            }
        });

        // í˜ì´ì§€ë¥¼ ë– ë‚  ë•Œ ì•Œë¦¼ (Electronì—ì„œëŠ” í•„ìš” ì—†ìŒ)
        // Electron ì•±ì—ì„œëŠ” ìë™ìœ¼ë¡œ ì €ì¥ë˜ë¯€ë¡œ ë³„ë„ ì•Œë¦¼ ë¶ˆí•„ìš”


        // ë°ì´í„° ì €ì¥ (Electron íŒŒì¼ ì‹œìŠ¤í…œ)
        async function saveData() {
            try {
                // localStorageì—ë„ ì €ì¥ (ë°±ì—…ìš©)
                localStorage.setItem('workshopParticipants', JSON.stringify(participants));
                localStorage.setItem('workshopGroups', JSON.stringify(groups));
                localStorage.setItem('workshopScores', JSON.stringify(scores));
                localStorage.setItem('workshopSettings', JSON.stringify(settings));
                localStorage.setItem('bingoItems', JSON.stringify(bingoItems));
                localStorage.setItem('checkedItems', JSON.stringify(Array.from(checkedItems)));
                
                // Electron íŒŒì¼ ì‹œìŠ¤í…œì— ì €ì¥
                const data = {
                    version: "1.0",
                    lastUpdated: new Date().toISOString(),
                    participants: participants,
                    groups: groups,
                    scores: scores,
                    settings: settings,
                    bingoItems: bingoItems,
                    checkedItems: Array.from(checkedItems)
                };
                
                const success = await window.electronAPI.writeData(data);
                if (!success) {
                    throw new Error('íŒŒì¼ ì €ì¥ ì‹¤íŒ¨');
                }
            } catch (error) {
                console.error('ë°ì´í„° ì €ì¥ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error);
                alert('ë°ì´í„° ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
            }
        }

        // JSON íŒŒì¼ë¡œ ìˆ˜ë™ ì €ì¥ (Electron íŒŒì¼ ì‹œìŠ¤í…œ)
        async function saveToJsonFile() {
            try {
                const data = {
                    version: "1.0",
                    lastUpdated: new Date().toISOString(),
                    participants: participants,
                    groups: groups,
                    scores: scores,
                    settings: settings,
                    bingoItems: bingoItems,
                    checkedItems: Array.from(checkedItems)
                };
                
                // Electron íŒŒì¼ ì‹œìŠ¤í…œì— ì €ì¥
                const success = await window.electronAPI.writeData(data);
                if (success) {
                    console.log('ë°ì´í„°ê°€ JSON íŒŒì¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.');
                    return true;
                } else {
                    throw new Error('íŒŒì¼ ì €ì¥ ì‹¤íŒ¨');
                }
            } catch (error) {
                console.error('JSON íŒŒì¼ ì €ì¥ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error);
                return false;
            }
        }


        // ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° (Electron íŒŒì¼ ì‹œìŠ¤í…œ)
        async function loadData() {
            try {
                // ë¨¼ì € Electron íŒŒì¼ ì‹œìŠ¤í…œì—ì„œ ë°ì´í„° ë¡œë“œ ì‹œë„
                const fileData = await window.electronAPI.readData();
                
                if (fileData) {
                    // íŒŒì¼ì—ì„œ ë°ì´í„° ë¡œë“œ
                    participants = fileData.participants || [];
                    groups = fileData.groups || [];
                    scores = fileData.scores || {};
                    settings = fileData.settings || {
                        totalGroups: 8,
                        maxMembersPerGroup: 6
                    };
                    bingoItems = fileData.bingoItems || [];
                    checkedItems = new Set(fileData.checkedItems || []);
                    console.log('JSON íŒŒì¼ì—ì„œ ë°ì´í„°ë¥¼ ë¡œë“œí–ˆìŠµë‹ˆë‹¤.');
                } else {
                    // íŒŒì¼ì´ ì—†ìœ¼ë©´ localStorageì—ì„œ ë¡œë“œ
                    const savedParticipants = localStorage.getItem('workshopParticipants');
                    const savedGroups = localStorage.getItem('workshopGroups');
                    const savedScores = localStorage.getItem('workshopScores');
                    const savedSettings = localStorage.getItem('workshopSettings');
                    const savedBingoItems = localStorage.getItem('bingoItems');
                    const savedCheckedItems = localStorage.getItem('checkedItems');

                    if (savedParticipants) {
                        participants = JSON.parse(savedParticipants);
                    }
                    if (savedGroups) {
                        groups = JSON.parse(savedGroups);
                    }
                    if (savedScores) {
                        scores = JSON.parse(savedScores);
                    }
                    if (savedSettings) {
                        settings = JSON.parse(savedSettings);
                    }
                    if (savedBingoItems) {
                        bingoItems = JSON.parse(savedBingoItems);
                    }
                    if (savedCheckedItems) {
                        checkedItems = new Set(JSON.parse(savedCheckedItems));
                    }
                    console.log('localStorageì—ì„œ ë°ì´í„°ë¥¼ ë¡œë“œí–ˆìŠµë‹ˆë‹¤.');
                }
            } catch (error) {
                console.error('ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error);
                alert('ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                // ê¸°ë³¸ê°’ìœ¼ë¡œ ì´ˆê¸°í™”
                participants = [];
                groups = [];
                scores = {};
                settings = {
                    totalGroups: 8,
                    maxMembersPerGroup: 6
                };
                bingoItems = [];
                checkedItems = new Set();
            }
        }

        // ì™¸ë¶€ íŒŒì¼ì—ì„œ ë°ì´í„° ë¡œë“œ (Electron íŒŒì¼ ì„ íƒ)
        async function loadFromExternalFile() {
            try {
                const data = await window.electronAPI.selectFile();
                if (data) {
                    // ë°ì´í„° ìœ íš¨ì„± ê²€ì‚¬
                    if (data.participants && data.groups && data.scores) {
                        participants = data.participants || [];
                        groups = data.groups || [];
                        scores = data.scores || {};
                        settings = data.settings || {
                            totalGroups: 8,
                            maxMembersPerGroup: 6
                        };
                        bingoItems = data.bingoItems || [];
                        checkedItems = new Set(data.checkedItems || []);
                        
                        saveData();
                        updateDisplay();
                        updateGroupAssignment();
                        updateGroupCountDisplay();
                        updateBingoItemsList();
                        
                        alert('ì™¸ë¶€ íŒŒì¼ì—ì„œ ë°ì´í„°ë¥¼ ì„±ê³µì ìœ¼ë¡œ ë¡œë“œí–ˆìŠµë‹ˆë‹¤.');
                    } else {
                        alert('ì˜ëª»ëœ ë°ì´í„° í˜•ì‹ì…ë‹ˆë‹¤.');
                    }
                }
            } catch (error) {
                console.error('ì™¸ë¶€ íŒŒì¼ ë¡œë“œ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error);
                alert('íŒŒì¼ ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
            }
        }

        // ì¡° ì´ˆê¸°í™”
        function initializeGroups() {
            if (groups.length === 0) {
                const totalGroups = settings.totalGroups || 8;
                for (let i = 1; i <= totalGroups; i++) {
                    groups.push({
                        id: i,
                        name: `${i}ì¡°`,
                        customName: '',
                        leader: null,
                        members: [],
                        score: 0,
                        createdAt: new Date().toISOString()
                    });
                    scores[`${i}ì¡°`] = 0;
                }
            }
        }

        // íƒ­ ì „í™˜
        function switchTab(tabName) {
            try {
                // ëª¨ë“  íƒ­ ë²„íŠ¼ ë¹„í™œì„±í™”
                document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
                
                // ì„ íƒëœ íƒ­ í™œì„±í™”
                event.target.classList.add('active');
                document.getElementById(tabName + '-tab').classList.add('active');
                
                if (tabName === 'settings') {
                    updateGroupAssignment();
                    updateGroupCountDisplay();
                } else if (tabName === 'etc') {
                    // ê¸°íƒ€ íƒ­ì—ì„œëŠ” íŠ¹ë³„í•œ ì´ˆê¸°í™” ì‘ì—…ì´ í•„ìš”í•˜ë©´ ì—¬ê¸°ì— ì¶”ê°€
                    updateBingoItemsList();
                    console.log('ê¸°íƒ€ íƒ­ì´ í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤.');
                }
            } catch (error) {
                console.error('íƒ­ ì „í™˜ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error);
                alert('íƒ­ ì „í™˜ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        }


        // ì°¸ê°€ì ë“±ë¡ (ì—‘ì…€ ë³µì‚¬/ë¶™ì—¬ë„£ê¸°)
        function importParticipants() {
            const excelInput = document.getElementById('excelInput');
            const data = excelInput.value.trim();
            
            if (!data) {
                alert('ì°¸ê°€ì ë°ì´í„°ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            const lines = data.split('\n');
            let addedCount = 0;

            lines.forEach(line => {
                const names = line.split('\t').filter(name => name.trim());
                names.forEach(name => {
                    const trimmedName = name.trim();
                    if (trimmedName && !participants.find(p => p.name === trimmedName)) {
                        participants.push({
                            id: Date.now() + Math.random(),
                            name: trimmedName,
                            createdAt: new Date().toISOString()
                        });
                        addedCount++;
                    }
                });
            });

            excelInput.value = '';
            saveData();
            updateDisplay();
            updateGroupAssignment();
            alert(`${addedCount}ëª…ì˜ ì°¸ê°€ìê°€ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤.`);
        }

        // ì „ì²´ ë°ì´í„° ì‚­ì œ
        function clearAllData() {
            if (confirm('ëª¨ë“  ë°ì´í„°ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                participants = [];
                groups = [];
                scores = {};
                settings = {
                    totalGroups: 8,
                    maxMembersPerGroup: 6
                };
                bingoItems = [];
                checkedItems = new Set();
                initializeGroups();
                saveData();
                updateDisplay();
                updateGroupAssignment();
                updateBingoItemsList();
            }
        }

        // ì¡° í¸ì„± ì¸í„°í˜ì´ìŠ¤ ì—…ë°ì´íŠ¸
        function updateGroupAssignment() {
            const container = document.getElementById('groupAssignment');
            container.innerHTML = '';

            groups.forEach(group => {
                const groupDiv = document.createElement('div');
                groupDiv.style.cssText = `
                    background: white;
                    border-radius: 10px;
                    padding: 15px;
                    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
                    border: 2px solid #e2e8f0;
                `;

                groupDiv.innerHTML = `
                    <h4 style="margin-bottom: 10px; color: #4a5568;">${group.name}</h4>
                    <div style="margin-bottom: 10px;">
                        <label style="font-size: 12px; color: #718096;">ì¡° ì´ë¦„:</label>
                        <input type="text" id="customName-${group.id}" placeholder="ì»¤ìŠ¤í…€ ì¡° ì´ë¦„ (ì„ íƒì‚¬í•­)" 
                               value="${group.customName || ''}"
                               onchange="updateCustomName(${group.id}, this.value)"
                               style="width: 100%; margin-top: 5px; padding: 6px; border: 1px solid #e2e8f0; border-radius: 4px;">
                    </div>
                    <div style="margin-bottom: 10px;">
                        <label style="font-size: 12px; color: #718096;">ì¡°ì¥:</label>
                        <input type="text" id="leader-${group.id}" placeholder="ì¡°ì¥ ì´ë¦„ ì…ë ¥" 
                               value="${group.leader ? participants.find(p => p.id === group.leader)?.name || '' : ''}"
                               onchange="assignLeaderByName(${group.id}, this.value)"
                               style="width: 100%; margin-top: 5px; padding: 6px; border: 1px solid #e2e8f0; border-radius: 4px;">
                    </div>
                    <div>
                        <label style="font-size: 12px; color: #718096;">ì¡°ì› (6ëª…, ì‰¼í‘œë¡œ êµ¬ë¶„):</label>
                        <textarea id="members-${group.id}" placeholder="ì¡°ì› ì´ë¦„ì„ ì‰¼í‘œë¡œ êµ¬ë¶„í•˜ì—¬ ì…ë ¥" 
                                  onchange="assignMembersByName(${group.id}, this.value)"
                                  style="width: 100%; height: 80px; margin-top: 5px; padding: 6px; border: 1px solid #e2e8f0; border-radius: 4px; resize: vertical;">${group.members.map(id => participants.find(p => p.id === id)?.name).filter(name => name).join(', ')}</textarea>
                    </div>
                `;
                container.appendChild(groupDiv);
            });
        }

        // ì»¤ìŠ¤í…€ ì¡° ì´ë¦„ ì—…ë°ì´íŠ¸
        function updateCustomName(groupId, customName) {
            const group = groups.find(g => g.id === groupId);
            if (group) {
                group.customName = customName.trim();
                saveData();
                updateDisplay();
            }
        }

        // ì¡° ìˆ˜ ì—…ë°ì´íŠ¸ (ì…ë ¥ê°’ ë³€ê²½ ì‹œ)
        function updateGroupCount(newCount) {
            const count = parseInt(newCount);
            if (count < 1 || count > 20) {
                alert('ì¡° ìˆ˜ëŠ” 1ê°œ ì´ìƒ 20ê°œ ì´í•˜ì—¬ì•¼ í•©ë‹ˆë‹¤.');
                document.getElementById('totalGroups').value = groups.length;
                return;
            }
        }

        // ì¡° ìˆ˜ ì ìš©
        function applyGroupCount() {
            const newCount = parseInt(document.getElementById('totalGroups').value);
            const currentCount = groups.length;
            
            if (newCount === currentCount) {
                return;
            }

            if (confirm(`${currentCount}ê°œ ì¡°ì—ì„œ ${newCount}ê°œ ì¡°ë¡œ ë³€ê²½í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\nê¸°ì¡´ ì¡° í¸ì„± ë°ì´í„°ê°€ ë³€ê²½ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.`)) {
                if (newCount > currentCount) {
                    // ì¡° ì¶”ê°€
                    for (let i = currentCount + 1; i <= newCount; i++) {
                        groups.push({
                            id: i,
                            name: `${i}ì¡°`,
                            customName: '',
                            leader: null,
                            members: [],
                            score: 0,
                            createdAt: new Date().toISOString()
                        });
                        scores[`${i}ì¡°`] = 0;
                    }
                } else {
                    // ì¡° ì œê±°
                    for (let i = currentCount; i > newCount; i--) {
                        const groupIndex = groups.findIndex(g => g.id === i);
                        if (groupIndex !== -1) {
                            const groupName = groups[groupIndex].name;
                            groups.splice(groupIndex, 1);
                            delete scores[groupName];
                        }
                    }
                }
                
                saveData();
                updateDisplay();
                updateGroupAssignment();
                updateGroupCountDisplay();
                alert(`${newCount}ê°œ ì¡°ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.`);
            } else {
                document.getElementById('totalGroups').value = currentCount;
            }
        }

        // ì¡° ìˆ˜ í‘œì‹œ ì—…ë°ì´íŠ¸
        function updateGroupCountDisplay() {
            const display = document.querySelector('#groupAssignment').previousElementSibling.querySelector('h4');
            if (display) {
                display.textContent = `ì¡° ìˆ˜ ì„¤ì • (í˜„ì¬ ${groups.length}ê°œ ì¡°ê°€ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤.)`;
            }
        }

        // ì´ë¦„ìœ¼ë¡œ ì¡°ì¥ í• ë‹¹
        function assignLeaderByName(groupId, leaderName) {
            const group = groups.find(g => g.id === groupId);
            if (group && leaderName) {
                const leader = participants.find(p => p.name === leaderName);
                if (leader) {
                    // ì¤‘ë³µ í™•ì¸
                    const duplicateGroups = groups.filter(g => g.id !== groupId && g.leader === leader.id);
                    if (duplicateGroups.length > 0) {
                        const duplicateGroupNames = duplicateGroups.map(g => g.name).join(', ');
                        if (confirm(`'${leaderName}'ì´(ê°€) ì´ë¯¸ ${duplicateGroupNames}ì˜ ì¡°ì¥ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤.\nê·¸ë˜ë„ ê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                            // ê¸°ì¡´ ì¡°ì¥ í•´ì œ
                            duplicateGroups.forEach(g => g.leader = null);
                            group.leader = leader.id;
                        } else {
                            // ì·¨ì†Œ ì‹œ ì…ë ¥ê°’ ì´ˆê¸°í™”
                            document.getElementById(`leader-${groupId}`).value = '';
                            return;
                        }
                    } else {
                        group.leader = leader.id;
                    }
                } else {
                    alert(`'${leaderName}' ì°¸ê°€ìë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`);
                    document.getElementById(`leader-${groupId}`).value = '';
                    return;
                }
                saveData();
                updateDisplay();
            }
        }

        // ì´ë¦„ìœ¼ë¡œ ì¡°ì› í• ë‹¹
        function assignMembersByName(groupId, memberNames) {
            const group = groups.find(g => g.id === groupId);
            if (group) {
                const names = memberNames.split(',').map(name => name.trim()).filter(name => name);
                const newMembers = [];
                const duplicates = [];
                
                names.forEach(memberName => {
                    const member = participants.find(p => p.name === memberName);
                    if (member) {
                        // ì¤‘ë³µ í™•ì¸ (ë‹¤ë¥¸ ì¡°ì— ì´ë¯¸ ì†í•œ ê²½ìš°)
                        const existingGroups = groups.filter(g => g.id !== groupId && g.members.includes(member.id));
                        if (existingGroups.length > 0) {
                            duplicates.push({
                                name: memberName,
                                groups: existingGroups.map(g => g.name)
                            });
                        } else {
                            newMembers.push(member.id);
                        }
                    }
                });
                
                // ì¤‘ë³µì´ ìˆëŠ” ê²½ìš° ì•Œë¦¼
                if (duplicates.length > 0) {
                    const duplicateInfo = duplicates.map(d => 
                        `'${d.name}' (ì´ë¯¸ ${d.groups.join(', ')}ì— ì†í•¨)`
                    ).join('\n');
                    
                    if (confirm(`ë‹¤ìŒ ì°¸ê°€ìë“¤ì´ ì´ë¯¸ ë‹¤ë¥¸ ì¡°ì— ì†í•´ ìˆìŠµë‹ˆë‹¤:\n\n${duplicateInfo}\n\nê·¸ë˜ë„ ê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n(ê¸°ì¡´ ì¡°ì—ì„œ ì œê±°ë©ë‹ˆë‹¤)`)) {
                        // ê¸°ì¡´ ì¡°ì—ì„œ ì œê±°
                        duplicates.forEach(duplicate => {
                            const member = participants.find(p => p.name === duplicate.name);
                            if (member) {
                                duplicate.groups.forEach(groupName => {
                                    const existingGroup = groups.find(g => g.name === groupName);
                                    if (existingGroup) {
                                        existingGroup.members = existingGroup.members.filter(id => id !== member.id);
                                    }
                                });
                                newMembers.push(member.id);
                            }
                        });
                    } else {
                        // ì·¨ì†Œ ì‹œ ì…ë ¥ê°’ ì´ˆê¸°í™”
                        document.getElementById(`members-${groupId}`).value = group.members.map(id => 
                            participants.find(p => p.id === id)?.name
                        ).filter(name => name).join(', ');
                        return;
                    }
                }
                
                // ì¡°ì› ìˆ˜ ì œí•œ í™•ì¸
                const maxMembers = settings.maxMembersPerGroup || 6;
                if (newMembers.length > maxMembers) {
                    alert(`ì¡°ì›ì€ ìµœëŒ€ ${maxMembers}ëª…ê¹Œì§€ ê°€ëŠ¥í•©ë‹ˆë‹¤. ì²˜ìŒ ${maxMembers}ëª…ë§Œ í• ë‹¹ë©ë‹ˆë‹¤.`);
                    newMembers.splice(maxMembers);
                }
                
                group.members = newMembers;
                saveData();
                updateDisplay();
            }
        }


        // ì ìˆ˜ ì—…ë°ì´íŠ¸
        function updateScore(groupName, newScore) {
            scores[groupName] = parseInt(newScore) || 0;
            const group = groups.find(g => g.name === groupName);
            if (group) {
                group.score = scores[groupName];
            }
            saveData();
            updateDisplay();
        }

        // ì ìˆ˜ ì¶”ê°€/ì°¨ê°
        function addScore(groupName, points) {
            const currentScore = scores[groupName] || 0;
            const newScore = Math.max(0, currentScore + points); // ìŒìˆ˜ ë°©ì§€
            updateScore(groupName, newScore);
        }



        // ì „ì—­ ë³€ìˆ˜: í˜„ì¬ ì„ íƒëœ ì¡°
        let selectedGroupName = null;

        // ì¡° ì„ íƒ
        function selectGroupForScoreAdjustment(groupName, displayName) {
            selectedGroupName = groupName;
            
            // íŒ¨ë„ í—¤ë” ì—…ë°ì´íŠ¸
            document.getElementById('selectedGroupName').textContent = displayName;
            document.getElementById('currentScoreValue').textContent = scores[groupName] || 0;
        }

        // ì ìˆ˜ ì¡°ì •
        function adjustScore(points) {
            if (selectedGroupName) {
                addScore(selectedGroupName, points);
                // í˜„ì¬ ì ìˆ˜ ì—…ë°ì´íŠ¸
                document.getElementById('currentScoreValue').textContent = scores[selectedGroupName] || 0;
            }
        }


        // ì ìˆ˜ ì´ˆê¸°í™”
        function resetScores() {
            if (confirm('ëª¨ë“  ì ìˆ˜ë¥¼ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                groups.forEach(group => {
                    group.score = 0;
                    scores[group.name] = 0;
                });
                saveData();
                updateDisplay();
            }
        }

        // í™”ë©´ ì—…ë°ì´íŠ¸
        function updateDisplay() {
            updateGroupsGrid();
            updateScoreboard();
            updateParticipantList();
            updateDataStatus();
        }

        // ë°ì´í„° ìƒíƒœ ì—…ë°ì´íŠ¸
        function updateDataStatus() {
            const statusDiv = document.getElementById('dataStatus');
            if (!statusDiv) return;
            
            const participantCount = participants.length;
            const groupCount = groups.length;
            const hasData = participantCount > 0 || Object.keys(scores).length > 0;
            
            if (hasData) {
                statusDiv.innerHTML = `
                    <span style="color: #4ade80; font-weight: 600;">âœ“ ìë™ ì €ì¥ë¨</span>
                `;
                statusDiv.style.background = 'rgba(74, 222, 128, 0.15)';
                statusDiv.style.border = '1px solid rgba(74, 222, 128, 0.3)';
            } else {
                statusDiv.innerHTML = `
                    <span style="color: #fbbf24; font-weight: 600;">âš  ë°ì´í„° ì—†ìŒ</span>
                `;
                statusDiv.style.background = 'rgba(251, 191, 36, 0.15)';
                statusDiv.style.border = '1px solid rgba(251, 191, 36, 0.3)';
            }
        }

        // ì¡° ê·¸ë¦¬ë“œ ì—…ë°ì´íŠ¸
        function updateGroupsGrid() {
            const grid = document.getElementById('groupsGrid');
            grid.innerHTML = '';

            groups.forEach(group => {
                const groupCard = document.createElement('div');
                groupCard.className = 'group-card clickable';
                groupCard.onclick = () => selectGroupForScoreAdjustment(group.name, group.customName || group.name);

                const leader = group.leader ? participants.find(p => p.id === group.leader) : null;
                const members = group.members.map(id => participants.find(p => p.id === id)).filter(p => p);
                
                groupCard.innerHTML = `
                    <div class="group-header">
                        <div class="group-title">
                            <div class="group-custom-name">${group.customName || group.name}</div>
                        </div>
                        <div class="group-score">${scores[group.name] || 0}ì </div>
                    </div>
                    ${leader ? `<div class="group-leader">${leader.name}</div>` : '<div style="color: #a0aec0; font-size: 14px;">ì¡°ì¥ ë¯¸ì§€ì •</div>'}
                    <div class="group-members">
                        ${members.map(member => `<span class="member-tag">${member.name}</span>`).join('')}
                        ${members.length === 0 ? '<span style="color: #a0aec0; font-size: 14px;">ì¡°ì› ì—†ìŒ</span>' : ''}
                    </div>
                `;
                grid.appendChild(groupCard);
            });
        }


        // ì ìˆ˜íŒ ì—…ë°ì´íŠ¸
        function updateScoreboard() {
            const tbody = document.getElementById('scoreTableBody');
            tbody.innerHTML = '';

            // ì ìˆ˜ìˆœìœ¼ë¡œ ì •ë ¬
            const sortedGroups = [...groups].sort((a, b) => (scores[b.name] || 0) - (scores[a.name] || 0));

            sortedGroups.forEach((group, index) => {
                const row = document.createElement('tr');
                const rankClass = index < 3 ? `rank-${index + 1}` : '';
                
                row.innerHTML = `
                    <td class="${rankClass}">${index + 1}ìœ„</td>
                    <td class="${rankClass}" style="text-align: left; padding-left: 20px;">
                        <strong style="font-size: 16px;">${group.customName || group.name}</strong>
                    </td>
                    <td class="${rankClass}">
                        <strong>${scores[group.name] || 0}</strong>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        // ì°¸ê°€ì ëª©ë¡ ì—…ë°ì´íŠ¸
        function updateParticipantList() {
            const list = document.getElementById('participantList');
            list.innerHTML = '';

            if (participants.length === 0) {
                list.innerHTML = '<div style="text-align: center; color: #a0aec0; padding: 20px;">ë“±ë¡ëœ ì°¸ê°€ìê°€ ì—†ìŠµë‹ˆë‹¤.</div>';
                return;
            }

            const grid = document.createElement('div');
            grid.className = 'participant-grid';

            participants.forEach(participant => {
                const item = document.createElement('div');
                item.className = 'participant-item';
                
                // ì¡° í• ë‹¹ ìƒíƒœ í™•ì¸
                const assignedGroup = groups.find(g => g.members.includes(participant.id));
                const isLeader = groups.find(g => g.leader === participant.id);
                
                if (isLeader) {
                    item.classList.add('leader');
                    const groupName = isLeader.name;
                    item.innerHTML = `
                        <span>${participant.name}</span>
                        <span class="group-badge">${groupName}</span>
                    `;
                } else if (assignedGroup) {
                    item.classList.add('assigned');
                    const groupName = assignedGroup.name;
                    item.innerHTML = `
                        <span>${participant.name}</span>
                        <span class="group-badge">${groupName}</span>
                    `;
                } else {
                    item.innerHTML = `<span>${participant.name}</span>`;
                }

                // í´ë¦­ìœ¼ë¡œ ì‚­ì œ
                item.onclick = () => removeParticipant(participant.id);
                grid.appendChild(item);
            });

            list.appendChild(grid);
        }

        // ì°¸ê°€ì ì‚­ì œ
        function removeParticipant(participantId) {
            if (confirm('ì´ ì°¸ê°€ìë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                participants = participants.filter(p => p.id !== participantId);
                // í•´ë‹¹ ì°¸ê°€ìê°€ ì†í•œ ì¡°ì—ì„œë„ ì œê±°
                groups.forEach(group => {
                    if (group.leader === participantId) {
                        group.leader = null;
                    }
                    group.members = group.members.filter(id => id !== participantId);
                });
                saveData();
                updateDisplay();
                updateGroupAssignment();
            }
        }

        // ë°ì´í„° ë‹¤ìš´ë¡œë“œ (ìˆ˜ë™ ë°±ì—…)
        async function downloadData() {
            try {
                const data = {
                    version: "1.0",
                    lastUpdated: new Date().toISOString(),
                    participants: participants,
                    groups: groups,
                    scores: scores,
                    settings: settings,
                    bingoItems: bingoItems,
                    checkedItems: Array.from(checkedItems)
                };
                
                const filePath = await window.electronAPI.saveFileAs(data);
                if (filePath) {
                    alert(`ë°±ì—… íŒŒì¼ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤: ${filePath}`);
                } else {
                    alert('ë°±ì—… íŒŒì¼ ì €ì¥ì´ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.');
                }
            } catch (error) {
                console.error('ë°ì´í„° ë‹¤ìš´ë¡œë“œ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error);
                alert('ë°ì´í„° ë‹¤ìš´ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
            }
        }

        // ë°ì´í„° ì—…ë¡œë“œ (ë³µì›)
        async function uploadData() {
            try {
                const data = await window.electronAPI.selectFile();
                if (data) {
                    // ë°ì´í„° ìœ íš¨ì„± ê²€ì‚¬
                    if (!data.participants || !data.groups || !data.scores) {
                        throw new Error('ì˜ëª»ëœ ë°ì´í„° í˜•ì‹ì…ë‹ˆë‹¤.');
                    }
                    
                    if (confirm('ê¸°ì¡´ ë°ì´í„°ë¥¼ ëª¨ë‘ ë®ì–´ì“°ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                        participants = data.participants || [];
                        groups = data.groups || [];
                        scores = data.scores || {};
                        settings = data.settings || {
                            totalGroups: 8,
                            maxMembersPerGroup: 6
                        };
                        bingoItems = data.bingoItems || [];
                        checkedItems = new Set(data.checkedItems || []);
                        
                        saveData();
                        updateDisplay();
                        updateGroupAssignment();
                        updateGroupCountDisplay();
                        updateBingoItemsList();
                        
                        alert('ë°ì´í„°ê°€ ì„±ê³µì ìœ¼ë¡œ ë³µì›ë˜ì—ˆìŠµë‹ˆë‹¤.');
                    }
                }
            } catch (error) {
                console.error('ë°ì´í„° ì—…ë¡œë“œ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error);
                alert('ë°ì´í„° ì—…ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. íŒŒì¼ í˜•ì‹ì„ í™•ì¸í•´ì£¼ì„¸ìš”.');
            }
        }


        // ë¹™ê³  í•­ëª© ë“±ë¡
        function addBingoItems() {
            const input = document.getElementById('bingoItemsInput');
            const data = input.value.trim();
            
            if (!data) {
                alert('ë¹™ê³  í•­ëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            const lines = data.split('\n');
            let addedCount = 0;

            lines.forEach(line => {
                const item = line.trim();
                if (item && !bingoItems.includes(item)) {
                    bingoItems.push(item);
                    addedCount++;
                }
            });

            input.value = '';
            updateBingoItemsList();
            saveData(); // ë°ì´í„° ì €ì¥
            alert(`${addedCount}ê°œì˜ ë¹™ê³  í•­ëª©ì´ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤.`);
        }

        // ë¹™ê³  í•­ëª© ëª©ë¡ ì´ˆê¸°í™”
        function clearBingoItems() {
            if (confirm('ëª¨ë“  ë¹™ê³  í•­ëª©ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                bingoItems = [];
                checkedItems.clear(); // ì²´í¬ëœ í•­ëª©ë“¤ë„ ì´ˆê¸°í™”
                updateBingoItemsList();
                saveData(); // ë°ì´í„° ì €ì¥
            }
        }

        // ë¹™ê³  í•­ëª© ëª©ë¡ ì—…ë°ì´íŠ¸
        function updateBingoItemsList() {
            const list = document.getElementById('bingoItemsList');
            list.innerHTML = '';

            if (bingoItems.length === 0) {
                list.innerHTML = '<div style="text-align: center; color: #a0aec0; padding: 20px;">ë“±ë¡ëœ ë¹™ê³  í•­ëª©ì´ ì—†ìŠµë‹ˆë‹¤.</div>';
                return;
            }

            const grid = document.createElement('div');
            grid.style.cssText = `
                display: grid;
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
                gap: 1px;
                background: #e2e8f0;
            `;

            bingoItems.forEach((item, index) => {
                const itemDiv = document.createElement('div');
                const isChecked = checkedItems.has(item);
                
                itemDiv.style.cssText = `
                    background: ${isChecked ? '#4ade80' : 'white'};
                    color: ${isChecked ? 'white' : '#4a5568'};
                    padding: 8px 12px;
                    font-size: 13px;
                    border-radius: 2px;
                    transition: all 0.2s ease;
                    cursor: pointer;
                    position: relative;
                    text-align: center;
                    font-weight: ${isChecked ? 'bold' : 'normal'};
                `;
                
                itemDiv.innerHTML = `
                    <span>${item}</span>
                    ${isChecked ? '<div style="position: absolute; top: 2px; right: 2px; font-size: 12px;">âœ“</div>' : ''}
                `;
                
                // í´ë¦­ìœ¼ë¡œ ì²´í¬/ì–¸ì²´í¬
                itemDiv.onclick = () => toggleBingoItem(item);
                grid.appendChild(itemDiv);
            });

            list.appendChild(grid);
        }

        // ë¹™ê³  í•­ëª© ì²´í¬/ì–¸ì²´í¬ í† ê¸€
        function toggleBingoItem(item) {
            if (checkedItems.has(item)) {
                checkedItems.delete(item);
            } else {
                checkedItems.add(item);
            }
            updateBingoItemsList();
            saveData(); // ë°ì´í„° ì €ì¥
        }


        // íƒ€ì´ë¨¸ ê´€ë ¨ ë³€ìˆ˜
        let timerInterval = null;
        let timerTimeLeft = 0;
        let timerRunning = false;

        // ìŠ¤í†±ì›Œì¹˜ ê´€ë ¨ ë³€ìˆ˜
        let stopwatchInterval = null;
        let stopwatchTime = 0;
        let stopwatchRunning = false;

        // íƒ€ì´ë¨¸ ì‹œì‘
        function startTimer() {
            const minutes = parseInt(document.getElementById('timerMinutes').value) || 0;
            const seconds = parseInt(document.getElementById('timerSeconds').value) || 0;
            
            if (minutes === 0 && seconds === 0) {
                alert('ì‹œê°„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            timerTimeLeft = minutes * 60 + seconds;
            timerRunning = true;
            
            document.getElementById('timerStartBtn').disabled = true;
            document.getElementById('timerPauseBtn').disabled = false;
            document.getElementById('timerMinutes').disabled = true;
            document.getElementById('timerSeconds').disabled = true;
            
            timerInterval = setInterval(() => {
                timerTimeLeft--;
                updateTimerDisplay();
                
                if (timerTimeLeft <= 0) {
                    clearInterval(timerInterval);
                    timerRunning = false;
                    document.getElementById('timerStartBtn').disabled = false;
                    document.getElementById('timerPauseBtn').disabled = true;
                    document.getElementById('timerMinutes').disabled = false;
                    document.getElementById('timerSeconds').disabled = false;
                    
                    // íƒ€ì´ë¨¸ ì™„ë£Œ ì•Œë¦¼
                    alert('â° íƒ€ì´ë¨¸ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!');
                }
            }, 1000);
        }

        // íƒ€ì´ë¨¸ ì •ì§€
        function pauseTimer() {
            if (timerRunning) {
                clearInterval(timerInterval);
                timerRunning = false;
                document.getElementById('timerStartBtn').disabled = false;
                document.getElementById('timerPauseBtn').disabled = true;
            }
        }

        // íƒ€ì´ë¨¸ ì´ˆê¸°í™”
        function resetTimer() {
            clearInterval(timerInterval);
            timerRunning = false;
            timerTimeLeft = 0;
            
            document.getElementById('timerStartBtn').disabled = false;
            document.getElementById('timerPauseBtn').disabled = true;
            document.getElementById('timerMinutes').disabled = false;
            document.getElementById('timerSeconds').disabled = false;
            document.getElementById('timerMinutes').value = '';
            document.getElementById('timerSeconds').value = '';
            
            updateTimerDisplay();
        }

        // íƒ€ì´ë¨¸ í‘œì‹œ ì—…ë°ì´íŠ¸
        function updateTimerDisplay() {
            const hours = Math.floor(timerTimeLeft / 3600);
            const minutes = Math.floor((timerTimeLeft % 3600) / 60);
            const seconds = timerTimeLeft % 60;
            
            const display = `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            document.getElementById('timerDisplay').textContent = display;
        }

        // ìŠ¤í†±ì›Œì¹˜ ì‹œì‘
        function startStopwatch() {
            stopwatchRunning = true;
            
            document.getElementById('stopwatchStartBtn').disabled = true;
            document.getElementById('stopwatchPauseBtn').disabled = false;
            
            stopwatchInterval = setInterval(() => {
                stopwatchTime++;
                updateStopwatchDisplay();
            }, 1000);
        }

        // ìŠ¤í†±ì›Œì¹˜ ì •ì§€
        function pauseStopwatch() {
            if (stopwatchRunning) {
                clearInterval(stopwatchInterval);
                stopwatchRunning = false;
                document.getElementById('stopwatchStartBtn').disabled = false;
                document.getElementById('stopwatchPauseBtn').disabled = true;
            }
        }

        // ìŠ¤í†±ì›Œì¹˜ ì´ˆê¸°í™”
        function resetStopwatch() {
            clearInterval(stopwatchInterval);
            stopwatchRunning = false;
            stopwatchTime = 0;
            
            document.getElementById('stopwatchStartBtn').disabled = false;
            document.getElementById('stopwatchPauseBtn').disabled = true;
            
            updateStopwatchDisplay();
        }

        // ìŠ¤í†±ì›Œì¹˜ í‘œì‹œ ì—…ë°ì´íŠ¸
        function updateStopwatchDisplay() {
            const hours = Math.floor(stopwatchTime / 3600);
            const minutes = Math.floor((stopwatchTime % 3600) / 60);
            const seconds = stopwatchTime % 60;
            
            const display = `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            document.getElementById('stopwatchDisplay').textContent = display;
        }

        // ë¬¸ì¥ í¼ì¦ ê²Œì„ ê´€ë ¨ ë³€ìˆ˜
        let puzzleChars = [];
        let shuffledChars = [];
        let correctSentence = '';

        // í¼ì¦ ìƒì„±
        function createPuzzle() {
            const sentence = document.getElementById('puzzleSentence').value.trim();
            
            if (!sentence) {
                alert('ë¬¸ì¥ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            // ê³µë°± ì œê±°í•˜ê³  ê¸€ì ë°°ì—´ë¡œ ë³€í™˜
            puzzleChars = sentence.replace(/\s/g, '').split('');
            correctSentence = sentence;
            
            if (puzzleChars.length < 4) {
                alert('ìµœì†Œ 4ê¸€ì ì´ìƒì˜ ë¬¸ì¥ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            // ê¸€ì ì„ê¸°
            shuffledChars = [...puzzleChars].sort(() => Math.random() - 0.5);
            
            // í¼ì¦ ê·¸ë¦¬ë“œ ìƒì„±
            createPuzzleGrid();
            
            // ê²Œì„ ì˜ì—­ í‘œì‹œ
            document.getElementById('puzzleGameArea').style.display = 'block';
        }

        // í¼ì¦ ê·¸ë¦¬ë“œ ìƒì„±
        function createPuzzleGrid() {
            const grid = document.getElementById('puzzleGrid');
            grid.innerHTML = '';
            
            // ê·¸ë¦¬ë“œ í¬ê¸° ê³„ì‚° (ìµœëŒ€ 4ì—´)
            const cols = Math.min(4, Math.ceil(Math.sqrt(shuffledChars.length)));
            const rows = Math.ceil(shuffledChars.length / cols);
            
            grid.style.gridTemplateColumns = `repeat(${cols}, 1fr)`;
            grid.style.gridTemplateRows = `repeat(${rows}, 1fr)`;
            
            shuffledChars.forEach((char, index) => {
                const cell = document.createElement('div');
                cell.className = 'puzzle-cell';
                cell.style.cssText = `
                    width: 60px;
                    height: 60px;
                    background: white;
                    border: 2px solid #e2e8f0;
                    border-radius: 8px;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-size: 20px;
                    font-weight: bold;
                    color: #4a5568;
                    transition: all 0.2s ease;
                    user-select: none;
                `;
                
                cell.textContent = char;
                grid.appendChild(cell);
            });
        }


        // í¼ì¦ ë‹¤ì‹œ ì„ê¸°
        function shufflePuzzle() {
            if (shuffledChars.length === 0) {
                alert('ë¨¼ì € í¼ì¦ì„ ìƒì„±í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            shuffledChars = [...puzzleChars].sort(() => Math.random() - 0.5);
            createPuzzleGrid();
        }

        // í¼ì¦ ì´ˆê¸°í™”
        function resetPuzzle() {
            puzzleChars = [];
            shuffledChars = [];
            correctSentence = '';
            
            document.getElementById('puzzleSentence').value = '';
            document.getElementById('puzzleGameArea').style.display = 'none';
        }

        // ì¹´ì¹´ì˜¤í†¡ ì˜¤í”ˆì±„íŒ…ë°© ê´€ë ¨ í•¨ìˆ˜ë“¤
        
        // ì±„íŒ…ë°© ì£¼ì†Œ ë³µì‚¬
        function copyChatUrl() {
            const chatUrl = document.getElementById('kakaoChatUrl').value.trim();
            
            if (!chatUrl) {
                alert('ë³µì‚¬í•  ì£¼ì†Œê°€ ì—†ìŠµë‹ˆë‹¤. ë¨¼ì € ì˜¤í”ˆì±„íŒ…ë°© ì£¼ì†Œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            navigator.clipboard.writeText(chatUrl).then(() => {
                alert('ì±„íŒ…ë°© ì£¼ì†Œê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
            }).catch(() => {
                // í´ë¦½ë³´ë“œ APIê°€ ì§€ì›ë˜ì§€ ì•ŠëŠ” ê²½ìš° ëŒ€ì²´ ë°©ë²•
                const textArea = document.createElement('textarea');
                textArea.value = chatUrl;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                alert('ì±„íŒ…ë°© ì£¼ì†Œê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
            });
        }
        
        // ì±„íŒ…ë°© ì—´ê¸°
        function openChatRoom() {
            const chatUrl = document.getElementById('kakaoChatUrl').value.trim();
            
            if (!chatUrl) {
                alert('ì—´ ì£¼ì†Œê°€ ì—†ìŠµë‹ˆë‹¤. ë¨¼ì € ì˜¤í”ˆì±„íŒ…ë°© ì£¼ì†Œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            window.open(chatUrl, '_blank');
        }
    </script>
</body>
</html>
